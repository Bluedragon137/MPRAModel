WARNING: If upgrading from v1.0 or v1.1 to v1.2. Note that chrombpnet has undergone linting to generate a modular structure for release on pypi.Hard-coded script paths are no longer necessary. Please refer to the updated README (below) to ensure your script calls are compatible with v1.2
2022-08-29_14-30-51: chrombpnet_train \
       --genome=data/reference/hg38.genome.fa \
       --bigwig=data/GM12878v2.bw \
       --nonpeaks=models/bias_model/filtered.bias_nonpeaks.bed \
       --params=models/bias_model/bias_model_params.tsv \
       --output_prefix=models/bias_model/bias \
       --chr_fold_path=data/splits/fold_0.json \
       --seed=1234 \
       --batch_size=64 \
       --architecture_from_file=/wynton/home/corces/allan/.conda/envs/MPRAModel/bin/bpnet_model.py \
       --trackables logcount_predictions_loss loss logits_profile_predictions_loss val_logcount_predictions_loss val_loss val_logits_profile_predictions_loss
2022-08-29 14:30:54.702019: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory
2022-08-29 14:30:54.702515: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-08-29 14:31:06.837850: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory
2022-08-29 14:31:06.838869: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcublas.so.11'; dlerror: libcublas.so.11: cannot open shared object file: No such file or directory
2022-08-29 14:31:06.840006: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcublasLt.so.11'; dlerror: libcublasLt.so.11: cannot open shared object file: No such file or directory
2022-08-29 14:31:06.846705: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcusolver.so.11'; dlerror: libcusolver.so.11: cannot open shared object file: No such file or directory
2022-08-29 14:31:06.847691: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcusparse.so.11'; dlerror: libcusparse.so.11: cannot open shared object file: No such file or directory
2022-08-29 14:31:06.848536: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudnn.so.8'; dlerror: libcudnn.so.8: cannot open shared object file: No such file or directory
2022-08-29 14:31:06.848975: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1850] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2022-08-29 14:31:06.850451: I tensorflow/core/platform/cpu_feature_guard.cc:151] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
WARNING: IF upgrading from v1.0 or v1.1 to v1.2, note that chrombpnet has undergone linting to generate a modular structure for release on pypi.Hard-coded script paths are no longer necessary. Please refer to the updated README to ensure your script calls are compatible with v1.2
{'counts_loss_weight': '6.3', 'filters': '128', 'n_dil_layers': '4', 'inputlen': '2114', 'outputlen': '1000', 'max_jitter': '0', 'chr_fold_path': 'data/splits/fold_0.json', 'negative_sampling_ratio': '1.0'}
params:
filters:128
n_dil_layers:4
conv1_kernel_size:21
profile_kernel_size:75
counts_loss_weight:6.3
got the model
loading nonpeaks...
got split:train for bed regions:(257413, 10)
loading nonpeaks...
got split:valid for bed regions:(25612, 10)
Epoch 1/50
   1/4023 [..............................] - ETA: 5:25:03 - loss: 349.9400 - logits_profile_predictions_loss: 240.5906 - logcount_predictions_loss: 17.3570   2/4023 [..............................] - ETA: 3:16:46 - loss: 310.9002 - logits_profile_predictions_loss: 238.3964 - logcount_predictions_loss: 11.5085   3/4023 [..............................] - ETA: 3:13:33 - loss: 280.2346 - logits_profile_predictions_loss: 230.2603 - logcount_predictions_loss: 7.9324    4/4023 [..............................] - ETA: 3:13:01 - loss: 272.3823 - logits_profile_predictions_loss: 226.7149 - logcount_predictions_loss: 7.2488   5/4023 [..............................] - ETA: 3:13:45 - loss: 264.2145 - logits_profile_predictions_loss: 224.6168 - logcount_predictions_loss: 6.2854   6/4023 [..............................] - ETA: 3:12:53 - loss: 256.9236 - logits_profile_predictions_loss: 223.3353 - logcount_predictions_loss: 5.3315   7/4023 [..............................] - ETA: 3:17:12 - loss: 252.6947 - logits_profile_predictions_loss: 223.2646 - logcount_predictions_loss: 4.6714   8/4023 [..............................] - ETA: 3:19:15 - loss: 248.6993 - logits_profile_predictions_loss: 221.9761 - logcount_predictions_loss: 4.2418   9/4023 [..............................] - ETA: 3:22:37 - loss: 244.4906 - logits_profile_predictions_loss: 219.6120 - logcount_predictions_loss: 3.9490  10/4023 [..............................] - ETA: 3:22:39 - loss: 240.6270 - logits_profile_predictions_loss: 217.2197 - logcount_predictions_loss: 3.7155  11/4023 [..............................] - ETA: 3:24:06 - loss: 238.5110 - logits_profile_predictions_loss: 216.5174 - logcount_predictions_loss: 3.4911  12/4023 [..............................] - ETA: 3:24:49 - loss: 235.3528 - logits_profile_predictions_loss: 214.8918 - logcount_predictions_loss: 3.2478  13/4023 [..............................] - ETA: 3:25:45 - loss: 233.6440 - logits_profile_predictions_loss: 214.5967 - logcount_predictions_loss: 3.0234  14/4023 [..............................] - ETA: 3:26:14 - loss: 230.4047 - logits_profile_predictions_loss: 212.2140 - logcount_predictions_loss: 2.8874  15/4023 [..............................] - ETA: 3:25:34 - loss: 228.7268 - logits_profile_predictions_loss: 211.3890 - logcount_predictions_loss: 2.7520  16/4023 [..............................] - ETA: 3:25:15 - loss: 225.3707 - logits_profile_predictions_loss: 208.4521 - logcount_predictions_loss: 2.6855  17/4023 [..............................] - ETA: 3:24:27 - loss: 222.6919 - logits_profile_predictions_loss: 206.5647 - logcount_predictions_loss: 2.5599  18/4023 [..............................] - ETA: 3:24:59 - loss: 220.2649 - logits_profile_predictions_loss: 204.6860 - logcount_predictions_loss: 2.4728  19/4023 [..............................] - ETA: 3:24:38 - loss: 218.3651 - logits_profile_predictions_loss: 203.2957 - logcount_predictions_loss: 2.3920  20/4023 [..............................] - ETA: 3:24:37 - loss: 217.0888 - logits_profile_predictions_loss: 202.4031 - logcount_predictions_loss: 2.3311  21/4023 [..............................] - ETA: 3:24:46 - loss: 216.0334 - logits_profile_predictions_loss: 201.6611 - logcount_predictions_loss: 2.2813  22/4023 [..............................] - ETA: 3:26:06 - loss: 214.9032 - logits_profile_predictions_loss: 200.8507 - logcount_predictions_loss: 2.2306  23/4023 [..............................] - ETA: 3:26:20 - loss: 213.8070 - logits_profile_predictions_loss: 200.1051 - logcount_predictions_loss: 2.1749  24/4023 [..............................] - ETA: 3:26:08 - loss: 212.5436 - logits_profile_predictions_loss: 199.1871 - logcount_predictions_loss: 2.1201  25/4023 [..............................] - ETA: 3:26:05 - loss: 211.3741 - logits_profile_predictions_loss: 198.4031 - logcount_predictions_loss: 2.0589  26/4023 [..............................] - ETA: 3:25:20 - loss: 210.5965 - logits_profile_predictions_loss: 198.0253 - logcount_predictions_loss: 1.9954  27/4023 [..............................] - ETA: 3:25:15 - loss: 209.0316 - logits_profile_predictions_loss: 196.5325 - logcount_predictions_loss: 1.9840  28/4023 [..............................] - ETA: 3:25:35 - loss: 208.2008 - logits_profile_predictions_loss: 195.9213 - logcount_predictions_loss: 1.9491  29/4023 [..............................] - ETA: 3:24:45 - loss: 207.5694 - logits_profile_predictions_loss: 195.6288 - logcount_predictions_loss: 1.8953  30/4023 [..............................] - ETA: 3:24:44 - loss: 207.0493 - logits_profile_predictions_loss: 195.3993 - logcount_predictions_loss: 1.8492  31/4023 [..............................] - ETA: 3:24:24 - loss: 206.4235 - logits_profile_predictions_loss: 195.0596 - logcount_predictions_loss: 1.8038