2022-09-27 20:18:43.392023: I tensorflow/core/platform/cpu_feature_guard.cc:151] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-09-27 20:18:46.432811: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1525] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 22846 MB memory:  -> device: 0, name: NVIDIA TITAN RTX, pci bus id: 0000:1b:00.0, compute capability: 7.5
2022-09-27 20:18:46.436406: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1525] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 22846 MB memory:  -> device: 1, name: NVIDIA TITAN RTX, pci bus id: 0000:61:00.0, compute capability: 7.5
2022-09-27 20:18:46.438474: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1525] Created device /job:localhost/replica:0/task:0/device:GPU:2 with 22846 MB memory:  -> device: 2, name: NVIDIA TITAN RTX, pci bus id: 0000:b2:00.0, compute capability: 7.5
2022-09-27 20:18:46.440455: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1525] Created device /job:localhost/replica:0/task:0/device:GPU:3 with 22846 MB memory:  -> device: 3, name: NVIDIA TITAN RTX, pci bus id: 0000:db:00.0, compute capability: 7.5
WARNING:tensorflow:No training configuration found in the save file, so the model was *not* compiled. Compile it manually.
here
Model: "model_1"
__________________________________________________________________________________________________
 Layer (type)                   Output Shape         Param #     Connected to                     
==================================================================================================
 sequence (InputLayer)          [(None, 2114, 4)]    0           []                               
                                                                                                  
 wo_bias_bpnet_1st_conv (Conv1D  (None, 2094, 512)   43520       ['sequence[0][0]']               
 )                                                                                                
                                                                                                  
 wo_bias_bpnet_1conv (Conv1D)   (None, 2090, 512)    786944      ['wo_bias_bpnet_1st_conv[0][0]'] 
                                                                                                  
 wo_bias_bpnet_1crop (Cropping1  (None, 2090, 512)   0           ['wo_bias_bpnet_1st_conv[0][0]'] 
 D)                                                                                               
                                                                                                  
 add (Add)                      (None, 2090, 512)    0           ['wo_bias_bpnet_1conv[0][0]',    
                                                                  'wo_bias_bpnet_1crop[0][0]']    
                                                                                                  
 wo_bias_bpnet_2conv (Conv1D)   (None, 2082, 512)    786944      ['add[0][0]']                    
                                                                                                  
 wo_bias_bpnet_2crop (Cropping1  (None, 2082, 512)   0           ['add[0][0]']                    
 D)                                                                                               
                                                                                                  
 add_1 (Add)                    (None, 2082, 512)    0           ['wo_bias_bpnet_2conv[0][0]',    
                                                                  'wo_bias_bpnet_2crop[0][0]']    
                                                                                                  
 wo_bias_bpnet_3conv (Conv1D)   (None, 2066, 512)    786944      ['add_1[0][0]']                  
                                                                                                  
 wo_bias_bpnet_3crop (Cropping1  (None, 2066, 512)   0           ['add_1[0][0]']                  
 D)                                                                                               
                                                                                                  
 add_2 (Add)                    (None, 2066, 512)    0           ['wo_bias_bpnet_3conv[0][0]',    
                                                                  'wo_bias_bpnet_3crop[0][0]']    
                                                                                                  
 wo_bias_bpnet_4conv (Conv1D)   (None, 2034, 512)    786944      ['add_2[0][0]']                  
                                                                                                  
 wo_bias_bpnet_4crop (Cropping1  (None, 2034, 512)   0           ['add_2[0][0]']                  
 D)                                                                                               
                                                                                                  
 add_3 (Add)                    (None, 2034, 512)    0           ['wo_bias_bpnet_4conv[0][0]',    
                                                                  'wo_bias_bpnet_4crop[0][0]']    
                                                                                                  
 wo_bias_bpnet_5conv (Conv1D)   (None, 1970, 512)    786944      ['add_3[0][0]']                  
                                                                                                  
 wo_bias_bpnet_5crop (Cropping1  (None, 1970, 512)   0           ['add_3[0][0]']                  
 D)                                                                                               
                                                                                                  
 add_4 (Add)                    (None, 1970, 512)    0           ['wo_bias_bpnet_5conv[0][0]',    
                                                                  'wo_bias_bpnet_5crop[0][0]']    
                                                                                                  
 wo_bias_bpnet_6conv (Conv1D)   (None, 1842, 512)    786944      ['add_4[0][0]']                  
                                                                                                  
 wo_bias_bpnet_6crop (Cropping1  (None, 1842, 512)   0           ['add_4[0][0]']                  
 D)                                                                                               
                                                                                                  
 add_5 (Add)                    (None, 1842, 512)    0           ['wo_bias_bpnet_6conv[0][0]',    
                                                                  'wo_bias_bpnet_6crop[0][0]']    
                                                                                                  
 wo_bias_bpnet_7conv (Conv1D)   (None, 1586, 512)    786944      ['add_5[0][0]']                  
                                                                                                  
 wo_bias_bpnet_7crop (Cropping1  (None, 1586, 512)   0           ['add_5[0][0]']                  
 D)                                                                                               
                                                                                                  
 add_6 (Add)                    (None, 1586, 512)    0           ['wo_bias_bpnet_7conv[0][0]',    
                                                                  'wo_bias_bpnet_7crop[0][0]']    
                                                                                                  
 wo_bias_bpnet_8conv (Conv1D)   (None, 1074, 512)    786944      ['add_6[0][0]']                  
                                                                                                  
 wo_bias_bpnet_8crop (Cropping1  (None, 1074, 512)   0           ['add_6[0][0]']                  
 D)                                                                                               
                                                                                                  
 add_7 (Add)                    (None, 1074, 512)    0           ['wo_bias_bpnet_8conv[0][0]',    
                                                                  'wo_bias_bpnet_8crop[0][0]']    
                                                                                                  
 wo_bias_bpnet_prof_out_precrop  (None, 1000, 1)     38401       ['add_7[0][0]']                  
  (Conv1D)                                                                                        
                                                                                                  
 wo_bias_bpnet_logitt_before_fl  (None, 1000, 1)     0           ['wo_bias_bpnet_prof_out_precrop[
 atten (Cropping1D)                                              0][0]']                          
                                                                                                  
 gap (GlobalAveragePooling1D)   (None, 512)          0           ['add_7[0][0]']                  
                                                                                                  
 wo_bias_bpnet_logits_profile_p  (None, 1000)        0           ['wo_bias_bpnet_logitt_before_fla
 redictions (Flatten)                                            tten[0][0]']                     
                                                                                                  
 wo_bias_bpnet_logcount_predict  (None, 1)           513         ['gap[0][0]']                    
 ions (Dense)                                                                                     
                                                                                                  
==================================================================================================
Total params: 6,377,986
Trainable params: 6,377,986
Non-trainable params: 0
__________________________________________________________________________________________________
None
Model: "model"
__________________________________________________________________________________________________
 Layer (type)                   Output Shape         Param #     Connected to                     
==================================================================================================
 input_1 (InputLayer)           [(None, 2114, 4)]    0           []                               
                                                                                                  
 input_2 (InputLayer)           [(None, 2114, 4)]    0           []                               
                                                                                                  
 model_1 (Functional)           [(None, 1000),       6377986     ['input_1[0][0]',                
                                 (None, 1)]                       'input_2[0][0]']                
                                                                                                  
 lambda (Lambda)                (None, 1000)         0           ['model_1[0][0]',                
                                                                  'model_1[0][1]']                
                                                                                                  
 lambda_1 (Lambda)              (None, 1000)         0           ['model_1[1][0]',                
                                                                  'model_1[1][1]']                
                                                                                                  
 lambda_2 (Lambda)              (None, 1000)         0           ['lambda[0][0]',                 
                                                                  'lambda_1[0][0]']               
                                                                                                  
 tf.expand_dims (TFOpLambda)    (None, 1000, 1)      0           ['lambda_2[0][0]']               
                                                                                                  
 conv1d (Conv1D)                (None, 996, 32)      192         ['tf.expand_dims[0][0]']         
                                                                                                  
 flatten (Flatten)              (None, 31872)        0           ['conv1d[0][0]']                 
                                                                                                  
 dense (Dense)                  (None, 64)           2039872     ['flatten[0][0]']                
                                                                                                  
 dense_1 (Dense)                (None, 1)            65          ['dense[0][0]']                  
                                                                                                  
==================================================================================================
Total params: 8,418,115
Trainable params: 8,418,115
Non-trainable params: 0
__________________________________________________________________________________________________
None
(2280, 2114, 4) (2280, 2114, 4) (2280,)
LR: 0.0001
Epoch 1/40
2022-09-27 20:18:52.188197: I tensorflow/stream_executor/cuda/cuda_dnn.cc:368] Loaded cuDNN version 8201
2022-09-27 20:18:54.327512: W tensorflow/stream_executor/gpu/asm_compiler.cc:111] *** WARNING *** You are using ptxas 11.0.221, which is older than 11.1. ptxas before 11.1 is known to miscompile XLA code, leading to incorrect results or invalid-address errors.

You may not need to update to CUDA 11.1; cherry-picking the ptxas binary is often sufficient.
  1/114 [..............................] - ETA: 21:04 - loss: 1.2877 - root_mean_squared_error: 1.2877  2/114 [..............................] - ETA: 33s - loss: 1.1601 - root_mean_squared_error: 1.1671    3/114 [..............................] - ETA: 32s - loss: 1.1411 - root_mean_squared_error: 1.1462  4/114 [>.............................] - ETA: 32s - loss: 1.1456 - root_mean_squared_error: 1.1494  5/114 [>.............................] - ETA: 31s - loss: 1.1580 - root_mean_squared_error: 1.1613  6/114 [>.............................] - ETA: 31s - loss: 1.1648 - root_mean_squared_error: 1.1676  7/114 [>.............................] - ETA: 31s - loss: 1.1768 - root_mean_squared_error: 1.1796  8/114 [=>............................] - ETA: 30s - loss: 1.1885 - root_mean_squared_error: 1.1913  9/114 [=>............................] - ETA: 30s - loss: 1.2088 - root_mean_squared_error: 1.2126 10/114 [=>............................] - ETA: 30s - loss: 1.2107 - root_mean_squared_error: 1.2142 11/114 [=>............................] - ETA: 30s - loss: 1.2156 - root_mean_squared_error: 1.2188 12/114 [==>...........................] - ETA: 29s - loss: 1.2282 - root_mean_squared_error: 1.2318 13/114 [==>...........................] - ETA: 29s - loss: 1.2339 - root_mean_squared_error: 1.2374 14/114 [==>...........................] - ETA: 29s - loss: 1.2188 - root_mean_squared_error: 1.2233 15/114 [==>...........................] - ETA: 28s - loss: 1.2102 - root_mean_squared_error: 1.2149 16/114 [===>..........................] - ETA: 28s - loss: 1.2058 - root_mean_squared_error: 1.2103 17/114 [===>..........................] - ETA: 28s - loss: 1.2058 - root_mean_squared_error: 1.2100 18/114 [===>..........................] - ETA: 27s - loss: 1.2006 - root_mean_squared_error: 1.2048 19/114 [====>.........................] - ETA: 27s - loss: 1.2093 - root_mean_squared_error: 1.2138 20/114 [====>.........................] - ETA: 27s - loss: 1.2059 - root_mean_squared_error: 1.2103 21/114 [====>.........................] - ETA: 27s - loss: 1.2059 - root_mean_squared_error: 1.2101 22/114 [====>.........................] - ETA: 26s - loss: 1.2100 - root_mean_squared_error: 1.2141 23/114 [=====>........................] - ETA: 26s - loss: 1.2087 - root_mean_squared_error: 1.2126 24/114 [=====>........................] - ETA: 26s - loss: 1.2058 - root_mean_squared_error: 1.2096 25/114 [=====>........................] - ETA: 25s - loss: 1.2054 - root_mean_squared_error: 1.2092 26/114 [=====>........................] - ETA: 25s - loss: 1.2103 - root_mean_squared_error: 1.2141 27/114 [======>.......................] - ETA: 25s - loss: 1.2089 - root_mean_squared_error: 1.2126 28/114 [======>.......................] - ETA: 25s - loss: 1.2080 - root_mean_squared_error: 1.2116 29/114 [======>.......................] - ETA: 24s - loss: 1.2167 - root_mean_squared_error: 1.2210 30/114 [======>.......................] - ETA: 24s - loss: 1.2219 - root_mean_squared_error: 1.2264 31/114 [=======>......................] - ETA: 24s - loss: 1.2201 - root_mean_squared_error: 1.2245 32/114 [=======>......................] - ETA: 23s - loss: 1.2176 - root_mean_squared_error: 1.2219 33/114 [=======>......................] - ETA: 23s - loss: 1.2099 - root_mean_squared_error: 1.2149 34/114 [=======>......................] - ETA: 23s - loss: 1.2171 - root_mean_squared_error: 1.2226 35/114 [========>.....................] - ETA: 23s - loss: 1.2164 - root_mean_squared_error: 1.2218 36/114 [========>.....................] - ETA: 22s - loss: 1.2152 - root_mean_squared_error: 1.2204 37/114 [========>.....................] - ETA: 22s - loss: 1.2202 - root_mean_squared_error: 1.2256 38/114 [=========>....................] - ETA: 22s - loss: 1.2189 - root_mean_squared_error: 1.2242 39/114 [=========>....................] - ETA: 21s - loss: 1.2131 - root_mean_squared_error: 1.2188 40/114 [=========>....................] - ETA: 21s - loss: 1.2157 - root_mean_squared_error: 1.2214 41/114 [=========>....................] - ETA: 21s - loss: 1.2130 - root_mean_squared_error: 1.2187 42/114 [==========>...................] - ETA: 21s - loss: 1.2161 - root_mean_squared_error: 1.2217 43/114 [==========>...................] - ETA: 20s - loss: 1.2169 - root_mean_squared_error: 1.2225 44/114 [==========>...................] - ETA: 20s - loss: 1.2161 - root_mean_squared_error: 1.2216 45/114 [==========>...................] - ETA: 20s - loss: 1.2176 - root_mean_squared_error: 1.2230 46/114 [===========>..................] - ETA: 19s - loss: 1.2150 - root_mean_squared_error: 1.2204 47/114 [===========>..................] - ETA: 19s - loss: 1.2150 - root_mean_squared_error: 1.2203 48/114 [===========>..................] - ETA: 19s - loss: 1.2145 - root_mean_squared_error: 1.2196 49/114 [===========>..................] - ETA: 18s - loss: 1.2145 - root_mean_squared_error: 1.2195 50/114 [============>.................] - ETA: 18s - loss: 1.2113 - root_mean_squared_error: 1.2165 51/114 [============>.................] - ETA: 18s - loss: 1.2090 - root_mean_squared_error: 1.2142 52/114 [============>.................] - ETA: 18s - loss: 1.2086 - root_mean_squared_error: 1.2137 53/114 [============>.................] - ETA: 17s - loss: 1.2094 - root_mean_squared_error: 1.2144 54/114 [=============>................] - ETA: 17s - loss: 1.2082 - root_mean_squared_error: 1.2131 55/114 [=============>................] - ETA: 17s - loss: 1.2082 - root_mean_squared_error: 1.2130 56/114 [=============>................] - ETA: 16s - loss: 1.2104 - root_mean_squared_error: 1.2153 57/114 [==============>...............] - ETA: 16s - loss: 1.2108 - root_mean_squared_error: 1.2157 58/114 [==============>...............] - ETA: 16s - loss: 1.2091 - root_mean_squared_error: 1.2139 59/114 [==============>...............] - ETA: 16s - loss: 1.2085 - root_mean_squared_error: 1.2133 60/114 [==============>...............] - ETA: 15s - loss: 1.2092 - root_mean_squared_error: 1.2139 61/114 [===============>..............] - ETA: 15s - loss: 1.2098 - root_mean_squared_error: 1.2144 62/114 [===============>..............] - ETA: 15s - loss: 1.2092 - root_mean_squared_error: 1.2137 63/114 [===============>..............] - ETA: 14s - loss: 1.2094 - root_mean_squared_error: 1.2138 64/114 [===============>..............] - ETA: 14s - loss: 1.2080 - root_mean_squared_error: 1.2125 65/114 [================>.............] - ETA: 14s - loss: 1.2066 - root_mean_squared_error: 1.2110 66/114 [================>.............] - ETA: 14s - loss: 1.2069 - root_mean_squared_error: 1.2113 67/114 [================>.............] - ETA: 13s - loss: 1.2073 - root_mean_squared_error: 1.2116 68/114 [================>.............] - ETA: 13s - loss: 1.2095 - root_mean_squared_error: 1.2139 69/114 [=================>............] - ETA: 13s - loss: 1.2081 - root_mean_squared_error: 1.2125 70/114 [=================>............] - ETA: 12s - loss: 1.2094 - root_mean_squared_error: 1.2138 71/114 [=================>............] - ETA: 12s - loss: 1.2082 - root_mean_squared_error: 1.2126 72/114 [=================>............] - ETA: 12s - loss: 1.2085 - root_mean_squared_error: 1.2128 73/114 [==================>...........] - ETA: 11s - loss: 1.2078 - root_mean_squared_error: 1.2121 74/114 [==================>...........] - ETA: 11s - loss: 1.2066 - root_mean_squared_error: 1.2109 75/114 [==================>...........] - ETA: 11s - loss: 1.2078 - root_mean_squared_error: 1.2120 76/114 [===================>..........] - ETA: 11s - loss: 1.2075 - root_mean_squared_error: 1.2117 77/114 [===================>..........] - ETA: 10s - loss: 1.2058 - root_mean_squared_error: 1.2100 78/114 [===================>..........] - ETA: 10s - loss: 1.2036 - root_mean_squared_error: 1.2079 79/114 [===================>..........] - ETA: 10s - loss: 1.2008 - root_mean_squared_error: 1.2053 80/114 [====================>.........] - ETA: 9s - loss: 1.2006 - root_mean_squared_error: 1.2051  81/114 [====================>.........] - ETA: 9s - loss: 1.1991 - root_mean_squared_error: 1.2036 82/114 [====================>.........] - ETA: 9s - loss: 1.1988 - root_mean_squared_error: 1.2033 83/114 [====================>.........] - ETA: 9s - loss: 1.1976 - root_mean_squared_error: 1.2021 84/114 [=====================>........] - ETA: 8s - loss: 1.1997 - root_mean_squared_error: 1.2042 85/114 [=====================>........] - ETA: 8s - loss: 1.1989 - root_mean_squared_error: 1.2034 86/114 [=====================>........] - ETA: 8s - loss: 1.1983 - root_mean_squared_error: 1.2027 87/114 [=====================>........] - ETA: 7s - loss: 1.1987 - root_mean_squared_error: 1.2031 88/114 [======================>.......] - ETA: 7s - loss: 1.1989 - root_mean_squared_error: 1.2032 89/114 [======================>.......] - ETA: 7s - loss: 1.2019 - root_mean_squared_error: 1.2065 90/114 [======================>.......] - ETA: 7s - loss: 1.2001 - root_mean_squared_error: 1.2048 91/114 [======================>.......] - ETA: 6s - loss: 1.2009 - root_mean_squared_error: 1.2056 92/114 [=======================>......] - ETA: 6s - loss: 1.2000 - root_mean_squared_error: 1.2047 93/114 [=======================>......] - ETA: 6s - loss: 1.2004 - root_mean_squared_error: 1.2050 94/114 [=======================>......] - ETA: 5s - loss: 1.1969 - root_mean_squared_error: 1.2020 95/114 [========================>.....] - ETA: 5s - loss: 1.1974 - root_mean_squared_error: 1.2024 96/114 [========================>.....] - ETA: 5s - loss: 1.2002 - root_mean_squared_error: 1.2055 97/114 [========================>.....] - ETA: 4s - loss: 1.1980 - root_mean_squared_error: 1.2034 98/114 [========================>.....] - ETA: 4s - loss: 1.1955 - root_mean_squared_error: 1.2011 99/114 [=========================>....] - ETA: 4s - loss: 1.1960 - root_mean_squared_error: 1.2016100/114 [=========================>....] - ETA: 4s - loss: 1.1949 - root_mean_squared_error: 1.2005101/114 [=========================>....] - ETA: 3s - loss: 1.1954 - root_mean_squared_error: 1.2009102/114 [=========================>....] - ETA: 3s - loss: 1.1947 - root_mean_squared_error: 1.2002